---
import { siteConfig } from "../config";

const hasProjects = siteConfig.projects?.length > 0;
const hasExperience = siteConfig.experience?.length > 0;
const hasEducation = siteConfig.education?.length > 0;
---

<header
  id="header"
  class="fixed top-0 left-0 right-0 z-50 hidden md:block bg-transparent transition-all duration-300 text-slate-300"
>
  <nav class="max-w-6xl mx-auto px-10 py-4">
    <ul class="flex items-center gap-10 justify-end text-sm font-medium accent-mono">
      <li>
        <a href="#about" class="nav-link">About</a>
      </li>

      {hasProjects && (
        <li>
          <a href="#projects" class="nav-link">Projects</a>
        </li>
      )}

      {hasExperience && (
        <li>
          <a href="#experience" class="nav-link">Experience</a>
        </li>
      )}

      {hasEducation && (
        <li>
          <a href="#education" class="nav-link">Education</a>
        </li>
      )}
    </ul>
  </nav>
</header>

<script>
  // Background blur & border on scroll
  window.addEventListener("scroll", () => {
    const header = document.getElementById("header");
    if (window.scrollY > 20) {
      header?.classList.add(
        "bg-slate-950/80",
        "backdrop-blur-lg",
        "border-b",
        "border-slate-800"
      );
    } else {
      header?.classList.remove(
        "bg-slate-950/80",
        "backdrop-blur-lg",
        "border-b",
        "border-slate-800"
      );
    }
  });

  // Active Section Highlight
  const navLinks = document.querySelectorAll(".nav-link");
  const sections = [...document.querySelectorAll("section[id]")];

  function activateNav() {
    let scrollPos = window.scrollY + 100;
    sections.forEach((sec) => {
      let offset = sec.offsetTop;
      let height = sec.offsetHeight;
      if (scrollPos >= offset && scrollPos < offset + height) {
        navLinks.forEach((link) => link.classList.remove("active-nav"));
        const active = document.querySelector(`.nav-link[href="#${sec.id}"]`);
        active?.classList.add("active-nav");
      }
    });
  }

  window.addEventListener("load", activateNav);
  window.addEventListener("scroll", activateNav);
</script>

<style>
  :root {
    --accent-color: ${siteConfig.accentColor};
  }

  .nav-link {
    padding-bottom: 3px;
    transition: color 0.25s, border-color 0.25s;
    border-bottom: 2px solid transparent;
  }

  .nav-link:hover {
    color: var(--accent-color);
    border-color: var(--accent-color);
  }

  .active-nav {
    color: var(--accent-color);
    border-bottom: 2px solid var(--accent-color);
  }
</style>